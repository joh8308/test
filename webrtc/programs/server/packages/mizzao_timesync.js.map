{"version":3,"sources":["meteor://ðŸ’»app/packages/mizzao:timesync/timesync-server.js"],"names":["WebApp","rawConnectHandlers","use","req","res","next","setHeader","origin","headers","test","end","Date","now","toString"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEAA,OAAOC,kBAAP,CAA0BC,GAA1B,CAA8B,YAA9B,EACE,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvB;AACA;AACAD,MAAIE,SAAJ,CAAc,eAAd,EAA+B,qCAA/B;AACAF,MAAIE,SAAJ,CAAc,QAAd,EAAwB,UAAxB;AACAF,MAAIE,SAAJ,CAAc,SAAd,EAAyB,CAAzB,EALuB,CAOvB;;AACAF,MAAIE,SAAJ,CAAc,cAAd,EAA8B,YAA9B,EARuB,CAUvB;AACA;AACA;AACA;;AACA,MAAMC,SAASJ,IAAIK,OAAJ,CAAYD,MAA3B;;AAEA,MAAIA,WAAYA,WAAW,qBAAX,IACZ,mCAAmCE,IAAnC,CAAwCF,MAAxC,CADA,CAAJ,EACwD;AACtDH,QAAIE,SAAJ,CAAc,6BAAd,EAA6CC,MAA7C;AACD;;AAEDH,MAAIM,GAAJ,CAAQC,KAAKC,GAAL,GAAWC,QAAX,EAAR;AACD,CAvBH,6G","file":"/packages/mizzao_timesync.js","sourcesContent":["// Use rawConnectHandlers so we get a response as quickly as possible\n// https://github.com/meteor/meteor/blob/devel/packages/webapp/webapp_server.js\n\nWebApp.rawConnectHandlers.use(\"/_timesync\",\n  function(req, res, next) {\n    // Never ever cache this, otherwise weird times are shown on reload\n    // http://stackoverflow.com/q/18811286/586086\n    res.setHeader(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n    res.setHeader(\"Pragma\", \"no-cache\");\n    res.setHeader(\"Expires\", 0);\n\n    // Avoid MIME type warnings in browsers\n    res.setHeader(\"Content-Type\", \"text/plain\");\n\n    // Cordova lives in a local webserver, so it does CORS\n    // we need to bless it's requests in order for it to accept our results\n    // Match http://localhost:<port> for Cordova clients in Meteor 1.3\n    // and http://meteor.local for earlier versions\n    const origin = req.headers.origin;\n\n    if (origin && ( origin === 'http://meteor.local' ||\n        /^http:\\/\\/localhost:1[23]\\d\\d\\d$/.test(origin) ) ) {\n      res.setHeader('Access-Control-Allow-Origin', origin);\n    }\n\n    res.end(Date.now().toString());\n  }\n);\n"]}